<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.plgrim.ncp.commons.dwsysbatch">

	<select id="selectListSysChckHistDW" parameterType="com.plgrim.ncp.base.entities.datasource1.sys.SysChckHist" resultType="com.plgrim.ncp.base.entities.datasource1.sys.SysChckHist"> 
		SELECT /* [commons.dwsysbatch.xml][selectListSysChckHistDW][시스템 점검 이력 리스트 조회 (DW)] */
		    CHCK_DT
		    , nvl((select CD_NM from md_sys_cd where rownum = 1 and CD = CHCK_JOB_SECT_CD), CHCK_JOB_SECT_CD) as CHCK_JOB_SECT_CD
		    , nvl((select CD_NM from md_sys_cd where rownum = 1 and CD = CHCK_TGT_SECT_CD), CHCK_TGT_SECT_CD) as CHCK_TGT_SECT_CD
		    , CHCK_CONT
		    , nvl((select CD_NM from md_sys_cd where rownum = 1 and CD = CHCK_RESULT_CD), CHCK_RESULT_CD) as CHCK_RESULT_CD
		    , RM_CONT 
		FROM SYS_CHCK_HIST
		WHERE 1 = 1
		    <if test='dayType != null and dayType == "TODAY_HOUR" '>
		    	AND to_char(CHCK_DT, 'YYYYMMDDHH24') = to_char(SYSDATE, 'YYYYMMDDHH24')
		    </if>
		    <if test='dayType != null and dayType == "TODAY_ALL" '>
		    	AND to_char(CHCK_DT, 'YYYYMMDD') = to_char(SYSDATE, 'YYYYMMDD')
		    </if>
		ORDER BY CHCK_DT, CHCK_JOB_SECT_CD, CHCK_TGT_SECT_CD, CHCK_RESULT_CD
	</select>
	
</mapper>